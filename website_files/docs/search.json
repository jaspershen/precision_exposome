{
  "articles": [
    {
      "path": "about.html",
      "title": "About this project",
      "description": "Some additional details about the website\n",
      "author": [
        {
          "name": "Peng Gao",
          "url": {}
        },
        {
          "name": "Xiaotao Shen",
          "url": "https://www.shenxt.info/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\n\n\n\n",
      "last_modified": "2021-03-11T09:23:36-08:00"
    },
    {
      "path": "figure1.html",
      "title": "Code for figure 1",
      "description": "Code for figure 1.\n",
      "author": [
        {
          "name": "Peng Gao",
          "url": {}
        },
        {
          "name": "Xiaotao Shen",
          "url": "https://www.shenxt.info/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\nLoad libraries\n\n\nShow code\n\nlibrary(tinyTools)\nlibrary(tidyverse)\nlibrary(circlize)\nlibrary(ComplexHeatmap)\nlibrary(patchwork)\n\n\n\nSet work directory\n\n\nShow code\n\ntinyTools::setwd_project()\n\n\nThe project name is: precision_exposome.Rproj \nThe project wd is: /Users/shenxt/projects/Peng/precision_exposome \n\nShow code\n\ngetwd()\n\n\n[1] \"/Users/shenxt/projects/Peng/precision_exposome\"\n\nFigure 1b\n\n\nShow code\n\n# load data\n##exposome chemical\nload(\"data_20200511/exposome/sample_info\")\nload(\"data_20200511/exposome/expression_data\")\n\nexposomeChemical_sample_info <- sample_info\nexposomeChemical_expression_data <- expression_data\n\nexposomeChemical_expression_data <-\n  exposomeChemical_expression_data %>%\n  t() %>% \n  as.data.frame() %>%\n  rownames_to_column(var = \"Sample_ID\") %>%\n  mutate(Sample_ID = stringr::str_replace(Sample_ID, \"_[0-9]{1,2}\", \"\")) %>%\n  plyr::dlply(.variables = \"Sample_ID\") %>%\n  lapply(function(x) {\n    apply(x[, -1], 2, mean)\n  }) %>%\n  do.call(rbind, .) %>% \n  t() %>% \n  as.data.frame()\n\n##metabolome\nload(\"data_20200511/metabolome/sample_info\")\nload(\"data_20200511/metabolome/expression_data\")\nmetabolome_sample_info <- sample_info\nmetabolome_expression_data <- expression_data\n\n##proteome\nload(\"data_20200511/proteome/sample_info\")\nload(\"data_20200511/proteome/expression_data\")\nproteome_sample_info <- sample_info\nproteome_expression_data <- expression_data\n\n##microbiome\nload(\"data_20200511/microbiome/dna_sample_info\")\nload(\"data_20200511/microbiome/dna_expression_data\")\nexposomeBiological_sample_info <- dna_sample_info\nexposomeBiological_expression_data <- dna_expression_data\nexposomeBiological_expression_data <- \n  exposomeBiological_expression_data[grep(\"phylum\", rownames(exposomeBiological_expression_data)),]\n  \n##cytokine\nload(\"data_20200511/cytokine/sample_info\")\nload(\"data_20200511/cytokine/expression_data\")\ncytokine_sample_info <- sample_info\ncytokine_expression_data <- expression_data\n\n##gut microbiome\nload(\"data_20200511/gut_microbiome/sample_info\")\nload(\"data_20200511/gut_microbiome/expression_data\")\ngutmicrobiome_sample_info <- sample_info\ngutmicrobiome_expression_data <- expression_data\n\ngutmicrobiome_sample_info <-\n  gutmicrobiome_sample_info %>% \n  dplyr::distinct(CollectionDate, .keep_all = TRUE)\n\ngutmicrobiome_expression_data <-\n  gutmicrobiome_expression_data[,gutmicrobiome_sample_info$sample_id]\n\n##environment\nload(\"data_20200511/environment/sample_info\")\nload(\"data_20200511/environment/expression_data\")\nenvironment_sample_info <- sample_info\nenvironment_expression_data <- expression_data\n\n##lab test\nload(\"data_20200511/lab_test/sample_info\")\nload(\"data_20200511/lab_test/expression_data\")\nlab_sample_info <- sample_info\nlab_expression_data <- expression_data\n\n###begin circlize\n\n##exposome chemical\nexposomeChemical_sample_info1 <- \n  exposomeChemical_sample_info %>% \n  dplyr::select(date = start_date) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"exp\")\n\n####exposome toxins and carcinogens\ntoxin_sample_info1 <- \n  metabolome_sample_info %>% \n  dplyr::select(date = CollectionDate) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"toxin\")\n\n##metabolome\nmetabolome_sample_info1 <- \n  metabolome_sample_info %>% \n  dplyr::select(date = CollectionDate) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"met\")\n\n##proteome\nproteome_sample_info1 <- \n  proteome_sample_info %>% \n  dplyr::select(date = CollectionDate) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"pro\")\n\n##microbiome\nexposomeBiological_sample_info1 <- \n  exposomeBiological_sample_info %>% \n  dplyr::select(date = date.start) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"micro\")\n\n##cytokine\ncytokine_sample_info1 <- \n  cytokine_sample_info %>% \n  dplyr::select(date = CollectionDate) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"cytokine\")\n\n##gut microbiome\ngutmicrobiome_sample_info1 <- \n  gutmicrobiome_sample_info %>% \n  dplyr::select(date = CollectionDate) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"gutmicrobiome\")\n\n##environment\nenvironment_sample_info1 <- \n  environment_sample_info %>% \n  dplyr::select(date = date.start) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"environment\")\n\n##lab test\nlab_sample_info1 <- \n  lab_sample_info %>% \n  dplyr::select(date = date.start) %>% \n  dplyr::mutate(date = as.Date(date),\n                class = \"lab\")\n\nall_date <- \n  data.frame(date = unique(c(\n    exposomeChemical_sample_info1$date,\n    metabolome_sample_info1$date,\n    toxin_sample_info1$date,\n    proteome_sample_info1$date,\n    exposomeBiological_sample_info1$date,\n    cytokine_sample_info1$date,\n    gutmicrobiome_sample_info1$date,\n    environment_sample_info1$date,\n    lab_sample_info1$date\n  ))) %>% \n  dplyr::filter(date >= \"2016-01-12\" & date <= \"2016-03-03\")\n  \nexposomeChemical_sample_info1 <-\n  all_date %>%\n  dplyr::left_join(exposomeChemical_sample_info1, by = c(\"date\")) %>%\n  dplyr::mutate(value =\n                  case_when(!is.na(class) ~ \"Yes\",\n                            TRUE ~ \"No\")) %>%\n  dplyr::mutate(class = class[!is.na(class)][1])\n\ntoxin_sample_info1 <-\n  all_date %>% \n  dplyr::left_join(toxin_sample_info1, by = c(\"date\")) %>% \n  dplyr::mutate(value = \n                  case_when(\n                    !is.na(class) ~ \"Yes\",\n                    TRUE ~ \"No\"\n                  )) %>% \n  dplyr::mutate(class = class[!is.na(class)][1])\n\nmetabolome_sample_info1 <-\n  all_date %>% \n  dplyr::left_join(metabolome_sample_info1, by = c(\"date\")) %>% \n  dplyr::mutate(value = \n                  case_when(\n                    !is.na(class) ~ \"Yes\",\n                    TRUE ~ \"No\"\n                  )) %>% \n  dplyr::mutate(class = class[!is.na(class)][1])\n\nproteome_sample_info1 <-\n  all_date %>% \n  dplyr::left_join(proteome_sample_info1, by = c(\"date\")) %>% \n  dplyr::mutate(value = \n                  case_when(\n                    !is.na(class) ~ \"Yes\",\n                    TRUE ~ \"No\"\n                  )) %>% \n  dplyr::mutate(class = class[!is.na(class)][1])\n\nexposomeBiological_sample_info1 <-\n  all_date %>% \n  dplyr::left_join(exposomeBiological_sample_info1, by = c(\"date\")) %>% \n  dplyr::mutate(value = \n                  case_when(\n                    !is.na(class) ~ \"Yes\",\n                    TRUE ~ \"No\"\n                  )) %>% \n  dplyr::mutate(class = class[!is.na(class)][1])\n\ncytokine_sample_info1 <-\n  all_date %>% \n  dplyr::left_join(cytokine_sample_info1, by = c(\"date\")) %>% \n  dplyr::mutate(value = \n                  case_when(\n                    !is.na(class) ~ \"Yes\",\n                    TRUE ~ \"No\"\n                  )) %>% \n  dplyr::mutate(class = class[!is.na(class)][1])\n\ngutmicrobiome_sample_info1 <-\n  all_date %>% \n  dplyr::left_join(gutmicrobiome_sample_info1, by = c(\"date\")) %>% \n  dplyr::mutate(value = \n                  case_when(\n                    !is.na(class) ~ \"Yes\",\n                    TRUE ~ \"No\"\n                  )) %>% \n  dplyr::mutate(class = class[!is.na(class)][1])\n\nenvironment_sample_info1 <-\n  all_date %>% \n  dplyr::left_join(environment_sample_info1, by = c(\"date\")) %>% \n  dplyr::mutate(value = \n                  case_when(\n                    !is.na(class) ~ \"Yes\",\n                    TRUE ~ \"No\"\n                  )) %>% \n  dplyr::mutate(class = class[!is.na(class)][1])\n\nlab_sample_info1 <-\n  all_date %>% \n  dplyr::left_join(lab_sample_info1, by = c(\"date\")) %>% \n  dplyr::mutate(value = \n                  case_when(\n                    !is.na(class) ~ \"Yes\",\n                    TRUE ~ \"No\"\n                  )) %>% \n  dplyr::mutate(class = class[!is.na(class)][1])\n\ntotal_sample_info <-\n  rbind(\n    exposomeChemical_sample_info1,\n    toxin_sample_info1,\n    metabolome_sample_info1,\n    proteome_sample_info1,\n    exposomeBiological_sample_info1,\n    cytokine_sample_info1,\n    gutmicrobiome_sample_info1,\n    environment_sample_info1,\n    lab_sample_info1\n  )\n\nvalue <- \n  c(\"Environment\" = ggsci::pal_d3()(10)[1],\n    \"Exposome (chemical)\" = ggsci::pal_d3()(10)[2],\n    \"Metabolome\" = ggsci::pal_d3()(10)[3],\n    \"Proteome\" = ggsci::pal_d3()(10)[4],\n    \"Exposome (biological)\" = ggsci::pal_d3()(10)[5],\n    \"Gut microbiome\" = ggsci::pal_d3()(10)[6],\n    \"Blood test\" = ggsci::pal_d3()(10)[7],\n    \"Cytokine\" = ggsci::pal_d3()(10)[8],\n    \"Toxins and carcinogens\" = ggsci::pal_d3()(10)[9]\n    )\n\ntotal_sample_info <- \n  total_sample_info %>% \n  dplyr::mutate(date = as.character(date)) %>%\n  dplyr::mutate(\n    class = case_when(\n      class == \"exp\" ~ \"Exposome (chemical)\",\n      class == \"micro\" ~ \"Exposome (biological)\",\n      class == \"met\" ~ \"Metabolome\",\n      class == \"pro\" ~ \"Proteome\",\n      class == \"lab\" ~ \"Blood test\",\n      class == \"cytokine\" ~ \"Cytokine\",\n      class == \"gutmicrobiome\" ~ \"Gut microbiome\",\n      class == \"environment\" ~ \"Environment\",\n      class == \"toxin\" ~ \"Toxins and carcinogens\"\n    )\n  ) %>% \n  dplyr::mutate(class = factor(class, levels = rev(\n    c(\n      \"Exposome (chemical)\",\n      \"Exposome (biological)\",\n      \"Environment\",\n      \"Metabolome\",\n      \"Toxins and carcinogens\",\n      \"Proteome\",\n      \"Blood test\",\n      \"Cytokine\",\n      \"Gut microbiome\"\n    )\n  )))\n  \n\nplot1 <- \ntotal_sample_info %>%\n  ggplot(aes(date, class)) +\n  geom_tile(aes(x = date, y = class, fill = value), color = \"black\", show.legend = FALSE) +\n  scale_y_discrete(expand = expansion(mult = c(0, 0))) +\n  scale_x_discrete(expand = expansion(mult = c(0, 0))) +\n  scale_fill_manual(values = c(\"Yes\" = \"red\", \"No\" = \"white\")) +\n  theme_bw() +\n  labs(x = \"\", y = \"\") +\n  theme(axis.text = element_text(\n    angle = 45,\n    hjust = 1,\n    vjust = 1\n  ),\n  axis.ticks.y = element_blank(),\n  plot.margin = unit(c(0, 0, 0, 0), \"pt\"),\n  panel.grid.minor = element_blank())\n\nplot2 <-\n  total_sample_info %>% \n    dplyr::filter(value == \"Yes\") %>% \n  dplyr::group_by(class) %>% \n  dplyr::summarise(n = n()) %>% \n    dplyr::ungroup() %>% \n  ggplot(aes(date, class)) +\n    geom_bar(aes(x = n, y = class), stat = \"identity\", color = \"black\") +\n    scale_x_continuous(expand = expansion(mult = c(0, 0))) +\n    scale_y_discrete(expand = expansion(mult = c(0, 0))) +\n    scale_fill_manual(values = c(\"Yes\" = \"red\", \"No\" = \"white\")) +\n    theme_classic() +\n    labs(x = \"Sample number\", y = \"\") +\n    theme(axis.text.x = element_text(\n      size = 12\n    ),\n    axis.text.y = element_blank(),\n    axis.title = element_text(size = 13),\n    axis.ticks.y = element_blank(),\n    plot.margin = unit(c(0, 0, 0, 0), \"pt\"),\n    panel.grid.minor = element_blank())\n\nplot3 <-\n  total_sample_info  %>% \n  dplyr::filter(value == \"Yes\") %>% \n  dplyr::group_by(date, class) %>% \n  dplyr::summarise(n = n()) %>% \n  dplyr::ungroup() %>% \n  ggplot(aes(date, n)) +\n  geom_bar(aes(x = date, y = n, fill = class), \n           stat = \"identity\", color = \"black\", show.legend = FALSE) +\n  guides(fill = guide_legend(nrow = 1)) +\n  scale_x_discrete(expand = expansion(mult = c(0, 0))) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0))) +\n  scale_fill_manual(values = value) +\n  guides(fill = guide_legend(nrow = 2)) +\n  theme_classic() +\n  labs(x = \"\", y = \"Sample number\") +\n  theme(axis.text.y = element_text(\n    size = 12\n  ),\n  axis.text.x = element_blank(),\n  axis.title = element_text(size = 13),\n  axis.ticks.x = element_blank(),\n  plot.margin = unit(c(0, 0, 0, 0), \"pt\"),\n  panel.grid.minor = element_blank(),\n  legend.position = \"top\")\n\nplot <-\n  {\n    plot3 + plot2 + plot_layout(ncol = 2, widths = c(5, 1))\n  } -\n  {\n    plot1 + plot2 + plot_layout(ncol = 2, widths = c(5, 1))\n  } +\n  plot_layout(ncol = 1, heights = c(1, 5))\n\nplot\n\n\n\n\n\n\n\n",
      "last_modified": "2021-03-11T09:23:40-08:00"
    },
    {
      "path": "index.html",
      "title": "Website for precision exposome",
      "description": "Welcome to the website for precision exposome. \n",
      "author": [
        {
          "name": "Peng Gao",
          "url": {}
        },
        {
          "name": "Xiaotao Shen",
          "url": "https://www.shenxt.info/"
        }
      ],
      "date": "`r Sys.Date()`",
      "contents": "\nCurrent environmental health studies mainly focus on limited stressors and populations, which can not address the complex and personal nature of exposures. Here we longitudinally profiled personal exposome and internal multi-omics to investigate how the exposome shaped an individual’s phenome chronically for the first time. Thousands of chemical and biological substances were identified in the personal exposome cloud. We performed correlational analyses within the exposome and inter -omics analyses between the exposome and gut microbiome, metabolome, and proteome, respectively. Furthermore, the exposome and multi-omics correlations were cross-validated using clinical test results. Our results showed agrochemicals and fungi predominated in the highly diverse and dynamic exposome, and the individual’s immune system, kidneys, and liver played essential roles in response to the personal exposome. Overall, our findings demonstrated that the exposome interacts with internal multi-omics dynamically and could impact one’s health status.\n\n\n\n",
      "last_modified": "2021-03-11T09:23:41-08:00"
    }
  ],
  "collections": []
}
